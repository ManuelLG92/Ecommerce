{% extends 'base.html.twig' %}


{% block title %}{{ title }}{% endblock %}



{% block body %}
    <div class="panel panel-flat">
        <div class="panel-heading">
            <h5 class="panel-title text-center">Cliente {{ client.companyName }}</h5>
            <hr>
            <div class="heading-elements">
                <ul class="icons-list">
                    <li><a data-action="collapse"></a></li>
                    <li><a data-action="reload"></a></li>
                    <li><a data-action="close"></a></li>
                </ul>
            </div>
        </div>


        <table class="table datatable-basic table-bordered">
            <thead>
            <tr>
                <th class="text-center">Tipo de producto</th>
                <th class="text-center">Descuento</th>
                <th class="text-center">Opciones</th>

            </tr>
            </thead>
            <tbody>

            {% for productType in productTypes %}
                {% for discount in discounts %}
                    <tr>
                    {% if discount.getProductTypeDiscount.id == productType.id %}
                        <td class="text-center">{{ productType.name }}</td>
                        <td class="text-center">
                            <form action="{{ path('edit_user_discount_put', {'id' : client.id , 'idDiscount' : discount.id }) }}"
                                  id="{{ 'formEdit' ~ productType.id }}"
                                  method="post">
                                <input type="hidden" name="_method" value="PUT">
                                <input type="hidden" name="productTypeId" value="{{ productType.id }}">
                                <input type="hidden" name="clientId" value="{{ client.id }}">
                                <input class="text-center"
                                       name="discount" id={{ 'discount' ~ productType.id }}
                                       value="{{ discount.discount }}">
                            </form>
                            <form method="post" id="{{ 'formDel' ~ productType.id }}"
                                  action="{{ path('delete_user_discount_put', {'id' : client.id , 'idDiscount' : discount.id }) }}"
                            >
                                <input type="hidden" class="" name="_token"
                                       value="{{ csrf_token('delete' ~ client.id) }}">
                                <input type="hidden" name="_method" value="DELETE">
                                <input type="hidden" name="productTypeId" value="{{ productType.id }}">
                                <input type="hidden" name="clientId" value="{{ client.id }}">
                                {# <button class="btn btn-link m-0"> <i class="icon-eraser3"></i>&nbsp;&nbsp;&nbsp;&nbsp;Eliminar</button> #}
                            </form>
                        </td>
                        <td>
                            <div class="text-center">

                                <button type="button" class="btn btn-lg btn-warning"
                                        onclick="SubmitForm('edit',
                                        {{ 'formEdit' ~ productType.id }},
                                        {{ 'discount' ~ productType.id }})">Editar
                                </button>

                                <button type="button" class="btn btn-lg btn-danger"
                                        onclick="SubmitForm('del',
                                        {{ 'formDel' ~ productType.id }},
                                        {{ 'discount' ~ productType.id }})">Eliminar
                                </button>
                            </div>
                        </td>
                        </tr>
                    {% else %}

                    {% endif %}

                {% endfor %}


            {% endfor %}
            {% for productType in productTypes %}

                {% for key, value in no_discounts %}

                    {% if value == productType.id %}
                        <tr>
                        <tr>
                            <td class="text-center">{{ productType.name }}</td>
                            <td class="text-center">
                                <form action="{{ path('create_user_discount', {'id' : client.id}) }}"
                                      id="{{ 'form' ~ productType.id }}"
                                      method="post">
                                    <input class="text-center" name="discount" id="{{ 'discount' ~ productType.id }}"
                                           required>
                                    <input type="hidden" name="productTypeId" value="{{ productType.id }}">
                                    <input type="hidden" name="clientId" value="{{ client.id }}">
                                </form>
                            </td>
                            <td class="text-center">
                                <div class="text-center">
                                    <input type="button" class="btn btn-lg btn-primary"
                                           value="Agregar descuento" onclick="SubmitForm('add',
                                    {{ 'form' ~ productType.id }},
                                    {{ 'discount' ~ productType.id }})"/>

                                </div>
                            </td>
                        </tr>
                    {% endif %}
                {% endfor %}

            {% endfor %}
            </tbody>
        </table>
    </div>
    <!-- /basic datatable -->




{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset('js/plugins/tables/datatables/datatables.min.js') }}"></script>
    <script src=" {{ asset('js/pages/datatables_basic.js') }}"></script>
    <script src="{{ asset('js/app/users/discountForm.js') }}"></script>

{% endblock %}